# AsyncStorage 최적화

Created: 2020년 6월 25일 오전 10:21
생성일: 2020년 6월 25일 오전 10:21

# **Promise 패턴 버리기**

Promise 패턴은 AsyncStorage의 성능을 저하시키는 또 다른 원인입니다. 저희의 실험에 따르면, Promise를 사용하는 경우 디스크 I/O가 없어도 2배 이상의 성능 저하가 있습니다. 실제로 AsyncStorage 처리에 Promise를 사용하는 경우와 사용하지 않는 경우의 성능 차이를 측정해 보니 둘 사이에 약 10-12배의 차이가 발생하였습니다.

# **메모리 캐싱**

메모리 캐싱은 데이터 저장소의 성능 향상을 위한 일반적인 접근 방식입니다. 데이터를 하나의 블럭에 담아 처리하는 방식에서는 블럭들과 블럭 메타데이터를 메모리에 올려두는 것이 성능 향상에 도움이 됩니다. 하지만 모든 데이터를 메모리에 올려놓을 수는 없으므로, 잘 사용하지 않는 데이터는 메모리에서 해제해주어야 합니다.

한가지 간단한 방법으로, LRU 캐시와 같이 메모리가 가질 수 있는 데이터의 수를 제한할 수 있습니다. 메모리에 있는 데이터의 수가 일정 수준 이상을 넘어서면 캐싱 프로세스가 오래된 데이터들을 메모리에서 해제합니다.

메모리가 많은 경우에는 위와 같이 오래된 데이터를 메모리에서 해제하는 것으로 충분합니다. 하지만 오래되고 느린 기기들에서는 메모리를 더 절약할 필요가 있는데, 이런 경우 메모리를 자진 해제하는 방식을 적용해보는 게 도움이 됩니다. 메모리를 할당할 때 해당 메모리에 유효기간을 두면, 기간 경과 시 메모리는 바로 해제가 됩니다. 이 방식을 이용하면 메모리 관리 프로세스에 약간의 성능 저하가 있을 수 있지만, 메모리를 더 유연하게 사용할 수 있어 전반적인 속도는 더 빨라질 수 있습니다.

참조 : [https://blog.sendbird.com/ko/react-native의-asyncstorage-최적화/](https://blog.sendbird.com/ko/react-native%ec%9d%98-asyncstorage-%ec%b5%9c%ec%a0%81%ed%99%94/)