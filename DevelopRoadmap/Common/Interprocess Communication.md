# Interprocess Communication

OS에서 동시성(concurrently)으로 동작되는 프로세스들은 둘 중 하나. 

- 다른 프로세스와 data를 공유하지 않고 독립적(independent)하거나,
- 다른 프로세스와 data를 공유하여 협력적(cooperating)하거나.

Cooperating를 허용하는 이유

- 정보 공유 : 다양한 응용 프로그램들이 동일한 데이터가 필요할 수 있으므로
- 계산 가속화 : 한 작업을 여러 프로세스가 나눠 병행처리하면 더 빨리 처리할 수 있음.
- 모듈성 : 기능을 모듈화하여 관리할 수 있다.
- 편의성 : 여러가지 기능을 동시에 즐기고 싶다.

이런 협력적 프로세스들이 데이터 공유를 위한 수단이 IPC( Interprocess Communication ).

![Untitled](images/Interprocess%20Communication/Untitled.png)

## 1. 공유 메모리(shared memory)

공유할 수 있는 메모리 공간을 만들어 해당 부분에 공유할 데이터를 저장

메모리에 저장, 사용측에서 바로 읽어서 쓰는 구조라 오버헤드가 매우 적지만, 동시성 문제들로 사용이 번거롭다.

### 생산자-소비자 문제

생산자가 데이터를 생산에 버퍼에 넣고, 소비자가 이를 사용하는 과정에서 발생할 수 있는 문제.

문제 1. 데이터가 없는 경우 : 소비자는 버퍼에서 데이터를 가져갈 수 없으므로 데이터 생산만을 기다린다.

문제 2. 버퍼가 꽉 찬 경우 : 생산자는 생산해도 버퍼에 넣지 못해 대기한다.

### 바쁜 대기(Busy waiting)

원하는 버퍼 상태(데이터 추가/버퍼공간 생김)를 위해 대기하는 상태. 대기하느라 바쁜 상태. CPU를 쓸데없이 붙잡아두고 있어 자원 낭비이다.

### 해결법

생산자, 소비자 쪽에 세마포어를 하나씩 추가한다

1. 버퍼가 가득 찬 경우 : 생산자에서 데이터 추가 후 버퍼가 가득 차있으면 블럭. 
해제 : 소비자에서 데이터를 가져갈 때.
2. 버퍼가 빈 경우 : 소비자가 가져갈 때 버퍼가 비어있으면 블럭.
해제 : 생산자가 데이터를 넣고 나서.

## 2. 메시지 전달(message passing)

프로세스들 사이에 교환되는 메시지를 통해 전달. OS에 의해 컨트롤 되는 방식.

process A가 커널에 메시지를 전달하면 커널이 B에게 메시지를 다시 전달해준다.

- direct communication : 커널이 B에게 직접 전달
- indirect : 커널이 메시지 박스에 넣어두고, B가 메시지 박스에서 가져다 씀

OS가 관리해주기 때문에 동기화 걱정이 없어 사용이 편하지만, 번거롭고 오버헤드가 크다.